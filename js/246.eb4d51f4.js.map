{"version":3,"file":"js/246.eb4d51f4.js","mappings":"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","sources":["webpack://hexschool-project-frontend/./src/views/FavoritePage.vue","webpack://hexschool-project-frontend/./src/views/FavoritePage.vue?9edb"],"sourcesContent":["<template>\n  <div class=\"container mt-5 min-vh-100\">\n    <h2>我的收藏</h2>\n    <div v-if=\"favoriteSpots.length === 0\"><p class=\"text-center text-secondary\">目前無收藏</p></div>\n    <table v-else class=\"table table-striped\">\n      <thead>\n        <tr>\n          <th scope=\"col\" width=\"100px\">景點名稱</th>\n          <th scope=\"col\">描述</th>\n          <th scope=\"col\">圖片網址</th>\n          <th scope=\"col\"></th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"favorite in favoriteSpots\" :key=\"favorite.id\">\n          <td>\n            <router-link :to=\"`/tourist-spot/${favorite.id}`\">{{ favorite.position }}</router-link>\n          </td>\n          <td>{{ favorite.description }}</td>\n          <td>{{ favorite.img_url }}</td>\n          <td class=\"text-end\">\n            <button type=\"button\" class=\"btn btn-outline-danger btn-sm\" @click=\"deleteFavoriteSpot(favorite.id)\">刪除</button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      favoriteSpots: [],\n    };\n  },\n  methods: {\n    getFavoriteSpots() {\n      const url = `${process.env.VUE_APP_API}/api/get-favorite`;\n      const token = document.cookie.replace(/(?:(?:^|.*;\\s*)accessToken\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\n\n      if (token) {\n        this.$http.defaults.headers.common.Authorization = `Bearer ${token}`;\n\n        this.$http\n          .get(url)\n          .then((res) => {\n            console.log(res);\n            this.favoriteSpots = res.data.favorite;\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    },\n    deleteFavoriteSpot(id) {\n      // this.alreadyFavorite = true;\n      const url = `${process.env.VUE_APP_API}/api/delete-favorite/${id}`;\n\n      const token = document.cookie.replace(/(?:(?:^|.*;\\s*)accessToken\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\n\n      if (token) {\n        this.$http.defaults.headers.common.Authorization = `Bearer ${token}`;\n\n        this.$http\n          .delete(url)\n          .then((res) => {\n            console.log(res);\n            this.getFavoriteSpots();\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    },\n    checkLogin() {\n      const token = document.cookie.replace(/(?:(?:^|.*;\\s*)accessToken\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\n\n      if (token) {\n        this.$http.defaults.headers.common.Authorization = `Bearer ${token}`;\n        const url = `${process.env.VUE_APP_API}/api/check-login`;\n        this.$http\n          .post(url)\n          .then((res) => {\n            console.log(res);\n            this.checkSuccess = true;\n          })\n          .catch((err) => {\n            console.log(err);\n            if (err.response.data.msg === 'Token has expired') {\n              console.log('過期');\n              this.refreshToken();\n            }\n            // this.$router.push('/login');\n          });\n      } else {\n        alert('尚未登入');\n        this.$router.push('/login');\n      }\n    },\n    refreshToken() {\n      const refreshToken = document.cookie.replace(/(?:(?:^|.*;\\s*)refreshToken\\s*=\\s*([^;]*).*$)|^.*$/, '$1');\n      this.$http.defaults.headers.common.Authorization = `Bearer ${refreshToken}`;\n      const refreshUrl = `${process.env.VUE_APP_API}/api/refresh`;\n\n      this.$http\n        .post(refreshUrl)\n        .then((res) => {\n          console.log(res);\n          document.cookie = `accessToken=${res.data.access_token}`;\n          document.cookie = `refreshToken=${refreshToken}`;\n          console.log(document.cookie);\n          this.checkLogin();\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n  },\n  mounted() {\n    this.checkLogin();\n    this.getFavoriteSpots();\n  },\n};\n</script>\n\n<style></style>\n","import { render } from \"./FavoritePage.vue?vue&type=template&id=8d302954\"\nimport script from \"./FavoritePage.vue?vue&type=script&lang=js\"\nexport * from \"./FavoritePage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\eva090029\\\\practice\\\\separate\\\\hexschool\\\\tourist-spots-frontend-main\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_hoisted_4","scope","width","_createElementBlock","_hoisted_1","_hoisted_2","$data","length","_hoisted_6","_hoisted_7","_Fragment","favorite","key","id","_createVNode","_component_router_link","to","position","description","img_url","_hoisted_8","type","onClick","$options","data","favoriteSpots","methods","getFavoriteSpots","url","token","document","cookie","replace","this","$http","defaults","headers","common","Authorization","get","then","res","console","log","catch","err","deleteFavoriteSpot","delete","checkLogin","post","checkSuccess","response","msg","refreshToken","alert","$router","push","refreshUrl","access_token","mounted","__exports__","render"],"sourceRoot":""}